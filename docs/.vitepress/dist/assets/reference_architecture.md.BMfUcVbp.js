import{_ as a,o,c as t,ag as r}from"./chunks/framework.CbQjVMS6.js";const h=JSON.parse('{"title":"Architecture","description":"","frontmatter":{},"headers":[],"relativePath":"reference/architecture.md","filePath":"reference/architecture.md","lastUpdated":1770414290000}'),l={name:"reference/architecture.md"};function c(i,e,s,n,d,u){return o(),t("div",null,[...e[0]||(e[0]=[r('<h1 id="architecture" tabindex="-1">Architecture <a class="header-anchor" href="#architecture" aria-label="Permalink to &quot;Architecture&quot;">​</a></h1><h2 id="workspace-layout" tabindex="-1">Workspace Layout <a class="header-anchor" href="#workspace-layout" aria-label="Permalink to &quot;Workspace Layout&quot;">​</a></h2><ul><li><code>packages/core</code>: player manager, queue, node pool, resolver orchestration, typed events.</li><li><code>packages/protocol</code>: Lavalink REST/WS clients, payload mapping, backoff.</li><li><code>packages/plugin-kit</code>: Result, YukitaError, plugin contracts, async event bus.</li><li><code>packages/gateway</code>: WebSocket command/event bridge for web and bot clients.</li><li><code>packages/docs</code>: npm module with bundled docs static assets.</li><li><code>packages/connectors/connector-discord</code>: Discord voice state/server adapter.</li><li><code>packages/plugins/*</code>: reference plugins (<code>metrics</code>, <code>resolve-cache</code>).</li></ul><h2 id="runtime-flow" tabindex="-1">Runtime Flow <a class="header-anchor" href="#runtime-flow" aria-label="Permalink to &quot;Runtime Flow&quot;">​</a></h2><ol><li>Connector receives external voice events.</li><li>Core routes updates into player state.</li><li>NodePool selects a Lavalink node for resolve/playback.</li><li>Protocol layer handles REST/WS exchange with retry + reconnect.</li><li>Core emits typed events and dispatches plugin hooks.</li><li>Gateway streams snapshots/diffs and accepts control commands.</li></ol><h2 id="multi-node-strategy" tabindex="-1">Multi-node Strategy <a class="header-anchor" href="#multi-node-strategy" aria-label="Permalink to &quot;Multi-node Strategy&quot;">​</a></h2><p>NodePool supports these strategies:</p><ul><li><code>penalty</code></li><li><code>least-load</code></li><li><code>lowest-latency</code></li><li><code>round-robin</code></li></ul><p>Selection can include preferred node and exclude lists for failover.</p><h2 id="consistency-guarantees" tabindex="-1">Consistency Guarantees <a class="header-anchor" href="#consistency-guarantees" aria-label="Permalink to &quot;Consistency Guarantees&quot;">​</a></h2><ul><li>Per-context event ordering is preserved.</li><li>Queue state remains in core, not in Lavalink only.</li><li>Failover migrates player voice/session state and restores playback telemetry.</li><li>Public APIs use Result instead of throw-based flow control.</li></ul><h2 id="error-model" tabindex="-1">Error Model <a class="header-anchor" href="#error-model" aria-label="Permalink to &quot;Error Model&quot;">​</a></h2><ul><li>Base type: <code>YukitaError</code>.</li><li>Stable <code>code</code> values are documented in <code>/reference/error-codes</code>.</li><li>Optional <code>meta</code> carries structured context.</li><li>Optional <code>cause</code> keeps source exception.</li></ul>',13)])])}const m=a(l,[["render",c]]);export{h as __pageData,m as default};
